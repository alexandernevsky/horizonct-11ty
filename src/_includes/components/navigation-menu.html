{# 
  Navigation Menu Component based on shadcn/ui with Alpine.js
  Usage:
    {% set navItems = [{"title": "Home", "href": "/", "children": []}, {"title": "About", "href": "/about/", "children": []}] %}
    {% include "components/navigation-menu.html" %}
#}
{% set navItems = navItems | default([]) %}
{% set navClass = navClass | default("") %}

<nav class="relative {{ navClass }}" x-data="{ activeItem: null }">
  <ul class="flex flex-wrap items-center gap-1">
    {% for item in navItems %}
    <li class="relative">
      {% if item.children and item.children | length > 0 %}
        {# Item with dropdown #}
        <div class="relative" x-data="{ open: false }" @mouseenter="open = true" @mouseleave="open = false">
          <button
            @click="open = !open"
            class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"
            :data-state="open ? 'open' : 'closed'"
          >
            {{ item.title }}
            <span class="ml-1 h-4 w-4 transition-transform duration-200" :class="{ 'rotate-180': open }">
              {% icon "chevron-down", { size: 16, class: "h-4 w-4" } %}
            </span>
          </button>
          
          <div
            x-show="open"
            x-transition:enter="transition ease-out duration-200"
            x-transition:enter-start="opacity-0 -translate-y-1"
            x-transition:enter-end="opacity-100 translate-y-0"
            x-transition:leave="transition ease-in duration-150"
            x-transition:leave-start="opacity-100 translate-y-0"
            x-transition:leave-end="opacity-0 -translate-y-1"
            class="absolute left-0 top-full z-50 mt-1 w-screen max-w-md overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg"
            style="display: none;"
          >
            <ul class="grid gap-1 p-4 md:w-[400px] lg:w-[500px] lg:grid-cols-[.75fr_1fr]">
              {% for child in item.children %}
              <li>
                <a
                  href="{{ child.href }}"
                  class="block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                >
                  <div class="text-sm font-medium leading-none">{{ child.title }}</div>
                  {% if child.description %}
                  <p class="line-clamp-2 text-sm leading-snug text-muted-foreground">{{ child.description }}</p>
                  {% endif %}
                </a>
              </li>
              {% endfor %}
            </ul>
          </div>
        </div>
      {% else %}
        {# Simple link item #}
        <a
          href="{{ item.href }}"
          class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"
          {% if item.active %}data-active="true"{% endif %}
        >
          {{ item.title }}
        </a>
      {% endif %}
    </li>
    {% endfor %}
  </ul>
</nav>

